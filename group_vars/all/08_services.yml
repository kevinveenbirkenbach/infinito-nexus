
# Services

## Meta
SYS_SERVICE_SUFFIX:                     ".{{ SOFTWARE_DOMAIN }}.service"

## Names
SYS_SERVICE_CLEANUP_BACKUPS:            "{{ lookup('unit_name', 'sys-ctl-cln-bkps'            ) }}"
SYS_SERVICE_CLEANUP_BACKUPS_FAILED:     "{{ lookup('unit_name', 'sys-ctl-cln-faild-bkps'      ) }}"
SYS_SERVICE_CLEANUP_ANONYMOUS_VOLUMES:  "{{ lookup('unit_name', 'sys-ctl-cln-anon-volumes'    ) }}"
SYS_SERVICE_CLEANUP_DISC_SPACE:         "{{ lookup('unit_name', 'sys-ctl-cln-disc-space'      ) }}"
SYS_SERVICE_CLEANUP_DOCKER:             "{{ lookup('unit_name', 'sys-ctl-cln-docker'          ) }}"
SYS_SERVICE_OPTIMIZE_DRIVE:             "{{ lookup('unit_name', 'svc-opt-ssd-hdd'             ) }}"
SYS_SERVICE_BACKUP_RMT_2_LOC:           "{{ lookup('unit_name', 'svc-bkp-rmt-2-loc'           ) }}"
SYS_SERVICE_BACKUP_DOCKER_2_LOC:        "{{ lookup('unit_name', 'sys-ctl-bkp-docker-2-loc'    ) }}"
SYS_SERVICE_REPAIR_CONTAINER_SOFT:      "{{ lookup('unit_name', 'sys-ctl-rpr-container-soft'  ) }}"
SYS_SERVICE_REPAIR_CONTAINER_HARD:      "{{ lookup('unit_name', 'sys-ctl-rpr-container-hard'  ) }}"

## On Failure
SYS_SERVICE_ON_FAILURE_COMPOSE:         "{{ lookup('unit_name','sys-ctl-alm-compose@', suffix=False ) }}%n.service"

## Groups
SYS_SERVICE_GROUP_BACKUPS: >
  {{ (('sys-ctl-bkp-' | get_category_entries) + ('svc-bkp-' | get_category_entries))
     | map('regex_replace', '$', SYS_SERVICE_SUFFIX) | list | sort }}

SYS_SERVICE_GROUP_CLEANUP: >
  {{ ('sys-ctl-cln-' | get_category_entries)
     | map('regex_replace', '$', SYS_SERVICE_SUFFIX) | list | sort }}

SYS_SERVICE_GROUP_REPAIR: >
  {{ ('sys-ctl-rpr-' | get_category_entries)
     | map('regex_replace', '$', SYS_SERVICE_SUFFIX) | list | sort }}

SYS_SERVICE_GROUP_OPTIMIZATION: >
  {{ ('svc-opt-' | get_category_entries)
     | map('regex_replace', '$', SYS_SERVICE_SUFFIX) | list | sort }}

SYS_SERVICE_GROUP_MAINTANANCE: >
  {{ ('svc-mtn-' | get_category_entries)
     | map('regex_replace', '$', SYS_SERVICE_SUFFIX) | list | sort }}
 
## Collection of services to manipulate the system
SYS_SERVICE_GROUP_MANIPULATION: >
  {{ 
    (
      SYS_SERVICE_GROUP_BACKUPS +
      SYS_SERVICE_GROUP_CLEANUP +
      SYS_SERVICE_GROUP_REPAIR +
      SYS_SERVICE_GROUP_OPTIMIZATION +
      SYS_SERVICE_GROUP_MAINTANANCE
    ) | sort
  }}
