- name: Ensure nginx config directory exists
  ansible.builtin.file:
    path: "{{ lookup('nginx_paths', want='files.configuration') | dirname }}"
    state: directory
    mode: "0755"

- name: Ensure base nginx.conf exists (bootstrap)
  ansible.builtin.copy:
    dest: "{{ lookup('nginx_paths', want='files.configuration') }}"
    force: false
    mode: "0644"
    content: |
      events {}
      http { server { listen 8080; return 200; } }

- name: "For '{{ application_id }}': Load docker-compose"
  include_role:
    name: docker-compose
  vars:
    docker_git_repository_pull:     false # Deactivated here to deactivate inhirement
    docker_compose_flush_handlers:  true

- name: "Verify that '{{ role_name }}' works"
  include_tasks: 02_assert.yml
  when: MODE_ASSERT | bool

- include_tasks: utils/once/flag.yml
