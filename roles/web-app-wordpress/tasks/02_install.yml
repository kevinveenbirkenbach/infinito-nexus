- name: "Run WordPress core install via WP CLI"
  no_log: "{{ MASK_CREDENTIALS_IN_LOGS | bool }}"
  command: >
    docker exec -u {{ wordpress_user }} {{ wordpress_container }}
    wp core install
      --url="{{ domains | get_url(application_id, WEB_PROTOCOL) }}"
      --title="{{ applications | get_app_conf(application_id, 'title', True) }}"
      --admin_user="{{ applications | get_app_conf(application_id, 'users.administrator.username') }}"
      --admin_password="{{ applications | get_app_conf(application_id, 'credentials.administrator_password', True) }}"
      --admin_email="{{ applications | get_app_conf(application_id, 'users.administrator.email', True) }}"
      --path="{{ wordpress_docker_html_path }}"
  args:
    chdir: "{{ docker_compose.directories.instance }}"
