- name: "Run WordPress core install via WP CLI"
  no_log: "{{ MASK_CREDENTIALS_IN_LOGS | bool }}"
  command: >
    docker exec -u {{ WORDPRESS_USER }} {{ WORDPRESS_CONTAINER }}
    wp core install
      --url="{{ WORDPRESS_URL }}"
      --title="{{ applications | get_app_conf(application_id, 'title', True) }}"
      --admin_user="{{ applications | get_app_conf(application_id, 'users.administrator.username') }}"
      --admin_password="{{ applications | get_app_conf(application_id, 'credentials.administrator_password', True) }}"
      --admin_email="{{ applications | get_app_conf(application_id, 'users.administrator.email', True) }}"
      --path="{{ WORDPRESS_DOCKER_HTML_PATH }}"
  args:
    chdir: "{{ docker_compose.directories.instance }}"
