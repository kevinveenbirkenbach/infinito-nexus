- name: Include dependency 'sys-svc-webserver-core'
  include_role:
    name: sys-svc-webserver-core
  when: run_once_sys_svc_webserver_core is not defined

- name: Generate color palette with colorscheme-generator
  set_fact:
    color_palette: "{{ lookup('colorscheme', CSS_BASE_COLOR, count=CSS_COUNT, shades=CSS_SHADES) }}"

- name: Generate inverted color palette with colorscheme-generator
  set_fact:
    inverted_color_palette: "{{ lookup('colorscheme', CSS_BASE_COLOR, count=CSS_COUNT, shades=CSS_SHADES, invert_lightness=True) }}"

- name: Deploy default CSS files
  template:
    src:    "{{ ['css', item ~ '.j2'] | path_join }}"
    dest:   "{{ [cdn_paths_all.shared.css, item] | path_join }}"
    owner:  "{{ NGINX.USER }}"
    group:  "{{ NGINX.USER }}"
    mode:   '0644'
  loop: "{{ CSS_FILES }}"
