title:                            "{{ SOFTWARE_NAME }} Shop"
features:
  redis:            true
  css:              true
server:
  csp:
    flags:
      script-src-elem:
        unsafe-inline:  true
        unsafe-eval:    true
    whitelist:
      font-src:
        - "data:"
  domains:
    aliases: []
    canonical:
      - shop.{{ DOMAIN_PRIMARY }}
docker:
  services:
    oidc:
      enabled: false
      shared: false
    logout:
      enabled: true
      shared: true
    ldap:
      enabled: false
      shared: false
    desktop:
      enabled: true
      shared: true
    matomo:
      enabled: true
      shared: true
    database:
      shared: true
      type: "mariadb"
      enabled: true

    init:
      name: "shopware-init"
      cpus: 1.0
      mem_reservation: 1g
      mem_limit: 2g

    shopware:
      image: "shopware/production"
      version: "6.7.3.1"
    
    php:
      image: "ghcr.io/shopware/docker-base"
      version: "8.3"
    
    web:
      name: "shopware-web"
      port: 8000
      cpus: 1.0
      mem_reservation: 1g
      mem_limit: 2g

    worker:
      name: "shopware-worker"
      entrypoint: [ "php", "bin/console", "messenger:consume", "async", "low_priority", "--time-limit=300", "--memory-limit=512M" ]
      replicas: 3
      cpus: 1.0
      mem_reservation: 1g
      mem_limit: 2g

    scheduler:
      name: "shopware-scheduler"
      entrypoint: [ "php", "bin/console", "scheduled-task:run" ]
      cpus: 0.5
      mem_reservation: 512m
      mem_limit: 1g

    redis:
      backup:
        disabled: true
      enabled: true
      image: "redis"
      version: "7-alpine"
      cpus: 0.25
      mem_reservation: 256m
      mem_limit: 512m

    opensearch:
      enabled: true
      image: "opensearchproject/opensearch"
      version: "2.12.0"
      name: "shopware-opensearch"
      cpus: 1.0
      mem_reservation: 2g
      mem_limit: 4g

  volumes:
    data: "shopware_data"
