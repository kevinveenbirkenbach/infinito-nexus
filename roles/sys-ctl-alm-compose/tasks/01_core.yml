- name: "Include dependent services for '{{ system_service_id  }}'"
  include_role:
    name: '{{ item }}'
  loop:
    - sys-ctl-alm-telegram
    - sys-ctl-alm-email
  vars:
    flush_handlers: true
    systemctl_timer_enabled: false
    systemctl_copy_files: true

- name: "Include core service for '{{ system_service_id  }}'"
  include_role:
    name: sys-service
  vars:
    flush_handlers: true
    systemctl_timer_enabled: false
    systemctl_copy_files: true
    systemctl_tpl_exec_start: "{{ system_service_script_exec }} %i"
    systemctl_tpl_on_failure: "" # No on failure needed, because it's anyhow the default on failure procedure

- name: "Send message to test service."
  systemd:
    name: "sys-ctl-alm-compose@{{ SYSTEMCTL_ALARM_COMPOSER_DUMMY_MESSAGE }}.service"
    state: started