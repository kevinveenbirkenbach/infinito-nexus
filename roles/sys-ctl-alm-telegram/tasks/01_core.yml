- name: Fail if Telegram bot credentials are not set
  assert:
    that:
    - TELEGRAM_BOT_TOKEN != ""
    - TELEGRAM_CHAT_ID != ""
    fail_msg: |
      Telegram configuration is incomplete!
      Please provide non‑empty values for:
        - TELEGRAM_BOT_TOKEN   # Your Telegram bot’s API token
        - TELEGRAM_CHAT_ID     # The Telegram chat ID to send messages to
  when: MODE_ASSERT | bool

- include_role:
    name: sys-service
  vars:
    # If the Telegram notifier fails, trigger the Email notifier,
    # passing the failing unit's name as the instance text.
    system_service_tpl_on_failure: "{{ ('sys-ctl-alm-email@') | get_service_name(SOFTWARE_NAME, False) }}%n.service"

- name: install curl
  community.general.pacman:
    name: curl
    state: present

- include_tasks: utils/once/flag.yml