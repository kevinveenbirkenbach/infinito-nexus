---
# Cleanup routine for Mastodon
# Removes cached remote media older than 14 days when MODE_CLEANUP is enabled.
- name: "Cleanup Mastodon media cache older than 14 days"
  command:
    cmd: "{{ BIN_CONTAINER }} exec -u root {{ MASTODON_CONTAINER }} bin/tootctl media remove --days=14"
  register: mastodon_cleanup
  changed_when: mastodon_cleanup.rc == 0
  failed_when: mastodon_cleanup.rc != 0
