single_user_mode:     false                                           # Set true for initial setup
features:
  matomo:             true
  css:                true
  desktop:            true
  oidc:               true
  central_database:   true
  logout:             true
server:
  domains:
    canonical:
      - "microblog.{{ PRIMARY_DOMAIN }}"
    aliases: []
  csp:
    whitelist:
      frame-src:
        - "*"
      worker-src:
        - "blob:"
docker:
  services:
    redis:
      backup:
        disabled: true
      enabled:            true
      cpus:               "0.3"
      mem_reservation:    "256m"
      mem_limit:          "512m"
      pids_limit:         256
    database: 
      enabled:            true
      cpus:               "1.0"
      mem_reservation:    "2g"
      mem_limit:          "3g"
      pids_limit:         512
    mastodon: 
      image:              "ghcr.io/mastodon/mastodon"
      version:            latest
      backup:
        no_stop_required: true
      name:               "mastodon"
      cpus:               "1.0"
      mem_reservation:    "1.5g"
      mem_limit:          "2g"
      pids_limit:         512
    streaming: 
      image:              "ghcr.io/mastodon/mastodon-streaming"
      version:            latest
      name:               "mastodon-streaming"
      cpus:               "0.3"
      mem_reservation:    "256m"
      mem_limit:          "512m"
      pids_limit:         256
    sidekiq:
      cpus:               "0.8"
      mem_reservation:    "1g"
      mem_limit:          "1.5g"
      pids_limit:         512
  volumes:
    data:                 "mastodon_data"
