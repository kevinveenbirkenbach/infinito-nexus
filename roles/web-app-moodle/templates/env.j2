
# General 
MOODLE_SITE_NAME="{{ lookup('config', application_id, 'site_titel') }}"
MOODLE_HOST="{{ lookup('domain',application_id) }}"
MOODLE_SSLPROXY=yes
MOODLE_REVERSE_PROXY=yes
MOODLE_USERNAME={{ lookup('config', application_id, 'users.administrator.username') }}
MOODLE_PASSWORD={{ lookup('config', application_id, 'credentials.user_password') | dotenv_quote }}
MOODLE_EMAIL={{ lookup('config', application_id, 'users.administrator.email')}}
BITNAMI_DEBUG={% if MODE_DEBUG | bool %}true{% else %}false{% endif %}

# Database
MOODLE_DATABASE_HOST={{ lookup('database', application_id, 'host') }}
MOODLE_DATABASE_PORT_NUMBER={{ lookup('database', application_id, 'port') }}
MOODLE_DATABASE_USER={{ lookup('database', application_id, 'username') }}
MOODLE_DATABASE_NAME={{ lookup('database', application_id, 'name') }}
MOODLE_DATABASE_PASSWORD={{ lookup('database', application_id, 'password') | dotenv_quote }}

{% if SYSTEM_EMAIL_ENABLED | bool %}
# SMTP 
MOODLE_SMTP_HOST={{ SYSTEM_EMAIL_HOST }}
MOODLE_SMTP_PORT_NUMBER={{ SYSTEM_EMAIL_PORT }}
MOODLE_SMTP_USER={{ users['no-reply'].email }}
MOODLE_SMTP_PASSWORD={{ users['no-reply'].tokens['web-app-mailu'] | dotenv_quote }}
MOODLE_SMTP_PROTOCOL={{ 'ssl' if SYSTEM_EMAIL_TLS else ('tls' if SYSTEM_EMAIL_START_TLS else '') }}
{% endif %}
