- name: Ensure hostname command exists (Arch)
  ansible.builtin.package:
    name: inetutils
    state: present
  when: ansible_facts.os_family == "Archlinux"

- name: Set system hostname to inventory_hostname (FQDN recommended)
  ansible.builtin.hostname:
    name: "{{ inventory_hostname }}"

- name: Ensure /etc/hosts contains FQDN + shortname mapping
  ansible.builtin.lineinfile:
    path: /etc/hosts
    regexp: '^127\.0\.1\.1\s+'
    line: "127.0.1.1 {{ inventory_hostname }}.localdomain {{ inventory_hostname }}"
    create: true
  
- include_tasks: utils/once/flag.yml
