# Base CDN root (shared across all roles)
CDN_ROOT:         "{{ lookup('nginx_paths','directories.data.cdn') }}"

# Default version identifier: UTC timestamp
CDN_VERSION:      "latest" # Latest is used atm because timestamp based would just lead to an unneccessary overhead

# Base Url to deliver the files
CDN_BASE_URL:     "{{ lookup('tls_resolve', 'web-svc-cdn', want='url.base') }}"

# Role specific CDN paths

## Build CDN path structure (via filter)
cdn_paths_all:    "{{ CDN_ROOT | cdn_paths(application_id, CDN_VERSION) }}"

## Global CDN dirs
CDN_DIRS_GLOBAL:  "{{ (cdn_paths_all.shared | cdn_dirs) + [cdn_paths_all.vendor] }}"

## Flatten CDN dict to list of all string paths
cdn_dirs_role:    "{{ cdn_paths_all.role | cdn_dirs }}"

# Dictionary with all urls
cdn_urls:         "{{ cdn_paths_all | cdn_urls(CDN_BASE_URL) }}"
