server
{
  server_name {{ lookup('domain',application_id) }};
  
  {% include 'roles/sys-front-tls/templates/nginx_ssl_header.j2' %}

  {% include 'roles/sys-front-inj-all/templates/server.conf.j2'%}

  {% include 'roles/sys-svc-proxy/templates/headers/content_security_policy.conf.j2' %}

  {% include 'roles/sys-svc-proxy/templates/headers/access_control_allow.conf.j2' %}
  
  charset utf-8;
  
  location /
  {
    alias {{ lookup('nginx','directories.data.cdn') }};  {# Path to your file directory #}
    autoindex on;                            {# Enable directory listing #}
    autoindex_exact_size off;                {# Display sizes in a human-readable format #}
    autoindex_localtime on;                  {# Show local time #}
    {% include 'roles/sys-front-inj-all/templates/location.lua.j2' %}
  }

  location /.well-known/ {
    alias {{ lookup('nginx','directories.data.well_known') }};
    allow all;
    default_type "text/plain";
    autoindex on;
  }
}
