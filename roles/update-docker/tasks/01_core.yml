- name: Include dependency 'sys-lock'
  include_role:
    name: sys-lock
  when: run_once_sys_lock is not defined

- name: "start sys-bkp-docker-2-loc-everything{{ SYS_SERVICE_SUFFIX }}"
  systemd:
    name: sys-bkp-docker-2-loc-everything{{ SYS_SERVICE_SUFFIX }}
    state: started
  when:
  - MODE_BACKUP | bool

- name: create {{update_docker_script}}
  template:
    src: update-docker.py.j2
    dest: "{{update_docker_script}}"

- name: configure update-docker{{ SYS_SERVICE_SUFFIX }}
  template:
    src: update-docker.service.j2
    dest: /etc/systemd/system/update-docker{{ SYS_SERVICE_SUFFIX }}

- name: "restart update-docker{{ SYS_SERVICE_SUFFIX }}"
  systemd:
    name: update-docker{{ SYS_SERVICE_SUFFIX }}
    state: restarted
    enabled: yes
    daemon_reload: yes
