- name: Load the '{{ application_id }}' role dependencies
  block:
  - name: "load required 'web-svc-logout' for {{ application_id }}"
    include_role: 
      name: web-svc-logout
    when: run_once_web_svc_logout is not defined

  - name: "load docker, db and proxy for {{ application_id }}"
    include_role:
      name: cmp-db-docker-proxy
    vars:
      docker_compose_flush_handlers: true
  when: KEYCLOAK_LOAD_DEPENDENCIES | bool

- name: "Load database & docker-compose variables if role dependencies aren't loaded"
  block:
    - include_tasks: "{{ playbook_dir }}/tasks/utils/load_handlers.yml"
      vars:
        handler_role_name: "docker-compose"
    - ansible.builtin.include_vars:
        file: "{{ item }}"
      loop:
        - "{{ playbook_dir }}/roles/docker-compose/vars/docker-compose.yml"
        - "{{ playbook_dir }}/roles/cmp-rdbms/vars/database.yml"
  when: not KEYCLOAK_LOAD_DEPENDENCIES | bool