# Environment File for Keycloak 
# Documentation can be found here: 
# @see https://www.keycloak.org/server/containers

KC_HOSTNAME={{ KEYCLOAK_DOMAIN }}
KC_HTTP_ENABLED=true

{% if not (lookup('tls_resolve', application_id, want='enabled') | bool) %}
# Deactivated for test deployment environmnets
KC_HOSTNAME_STRICT=false
KC_HOSTNAME_STRICT_HTTPS=false
{% endif %}

# Proxy
KC_PROXY_HEADERS=xforwarded

# Health Checks
# @see https://quarkus.io/guides/smallrye-health
KC_HEALTH_ENABLED={{ KEYCLOAK_HEALTH_ENABLED | lower }}
KC_METRICS_ENABLED=true

# Database
KC_DB={{ lookup('database', application_id, want='type') }}
KC_DB_URL={{ lookup('database', application_id, want='url_jdbc') }}
KC_DB_USERNAME={{ lookup('database', application_id, want='username') }}
KC_DB_PASSWORD={{ lookup('database', application_id, want='password') | dotenv_quote }}

# Credentials

## Bootstrap
KC_BOOTSTRAP_ADMIN_USERNAME={{ KEYCLOAK_BOOTSTRAP_ADMIN_USERNAME }}
KC_BOOTSTRAP_ADMIN_PASSWORD={{ KEYCLOAK_BOOTSTRAP_ADMIN_PASSWORD | dotenv_quote }}

## Permanent
KEYCLOAK_PERMANENT_ADMIN_USERNAME={{ KEYCLOAK_PERMANENT_ADMIN_USERNAME }}
KEYCLOAK_PERMANENT_ADMIN_PASSWORD={{ KEYCLOAK_PERMANENT_ADMIN_PASSWORD | dotenv_quote }}

# Enable detailed logs
{% if MODE_DEBUG | bool %}
KC_LOG_LEVEL=INFO
KC_LOG_LEVEL_ORG_KEYCLOAK_STORAGE_LDAP=DEBUG
KC_LOG_LEVEL_ORG_LDAPSDK=DEBUG
{% endif %}
