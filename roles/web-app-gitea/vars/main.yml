# General
application_id:                 "web-app-gitea"
database_type:                  "mariadb"

# Docker
container_port:                 "{{ applications | get_app_conf(application_id, 'docker.services.gitea.port') }}"
docker_compose_flush_handlers:  true

# Gitea
GITEA_LDAP_AUTH_ARGS:
  - '--name "LDAP ({{ PRIMARY_DOMAIN }})"'
  - '--host "{{ ldap.server.domain }}"'
  - '--port {{ ldap.server.port }}'
  - '--security-protocol "{{ ldap.server.security | trim or "unencrypted" }}"'
  - '--bind-dn "{{ ldap.dn.administrator.data }}"'
  - '--bind-password "{{ ldap.bind_credential }}"'
  - '--user-search-base "{{ ldap.dn.ou.users }}"'
  - '--user-filter  "(&(objectClass=inetOrgPerson)(uid=%s))"'
  - '--username-attribute "{{ ldap.user.attributes.id }}"'
  - '--firstname-attribute "{{ ldap.user.attributes.firstname }}"'
  - '--surname-attribute "{{ ldap.user.attributes.surname }}"'
  - '--email-attribute "{{ ldap.user.attributes.mail }}"'
  - '--public-ssh-key-attribute "{{ ldap.user.attributes.ssh_public_key }}"'
  - '--synchronize-users'
GITEA_VERSION:    "{{ applications | get_app_conf(application_id, 'docker.services.gitea.version') }}"
GITEA_IMAGE:      "{{ applications | get_app_conf(application_id, 'docker.services.gitea.image') }}"
GITEA_CONTAINER:  "{{ applications | get_app_conf(application_id, 'docker.services.gitea.name') }}"
GITEA_VOLUME:     "{{ applications | get_app_conf(application_id, 'docker.volumes.data') }}"
GITEA_USER:       "git"
GITEA_CONFIG:     "/data/gitea/conf/app.ini"
