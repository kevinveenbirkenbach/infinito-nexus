features:
  central_database:   true
  oauth2:             false

  # Matomo can't use the following settings - At least not on the initial setup run
  desktop:            false  # Didn't work in frame didn't have high priority @todo figure out why and solve it
  css:                false
  logout:             false
  matomo:             false

site_name: "Matomo on {{ DOMAIN_PRIMARY }}"
token:
  description:  "Created by {{ SOFTWARE_NAME }}"

server:
  csp:
    whitelist:
      script-src-elem:
        - https://cdn.matomo.cloud
      style-src-elem:
        - https://fonts.googleapis.com
    flags:
      script-src-attr:
        unsafe-eval:   true
      script-src-elem:
        unsafe-inline: true
        unsafe-eval:   true
      style-src-attr:
        unsafe-inline: true
        unsafe-eval:   true
  domains:
    canonical:
      - "matomo.{{ DOMAIN_PRIMARY }}"
    aliases: []
excluded_ips: "{{ networks.internet.values() | list }}"

docker:
  services:
    matomo:
      image:            "matomo"
      version:          "latest"
      name:             "matomo"
      backup:
        no_stop_required: true
      cpus:               1.0
      mem_reservation:    0.5g
      mem_limit:          1g
      pids_limit:         512

    bootstrap:
      image:              "ghcr.io/kevinveenbirkenbach/matomo-bootstrap"
      version:            "stable"
      name:               "matomo-bootstrap"
      profiles:
        - "bootstrap"
      timeout:            30
      cpus:               1.0
      mem_reservation:    0.5g
      mem_limit:          1g
      pids_limit:         512

    database:
      enabled: true
    redis:
      backup:
        disabled: true
      enabled: false
  volumes: 
    data: matomo_data
