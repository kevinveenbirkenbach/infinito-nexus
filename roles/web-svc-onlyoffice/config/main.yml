server:
  status_codes:
    default:
      - 308
      - 302
  domains:
    canonical:
      - "onlyoffice.{{ DOMAIN_PRIMARY }}"
    aliases: []
  csp:
    whitelist:
      frame-ancestors:
        - "*.{{ DOMAIN_PRIMARY }}"
      script-src-elem:
        - "https://fonts.googleapis.com"
      style-src-elem:
        - "https://fonts.googleapis.com"
      font-src:
        - "https://fonts.gstatic.com"
    flags:
      script-src-attr:
        unsafe-inline:  true
      script-src-elem:
        unsafe-inline:  true
        unsafe-eval:    true
compose:
  services:
    logout:
      enabled: false
      shared: false
    dashboard:
      enabled: true
    matomo:
      enabled: true
      shared: true
    redis:
      backup:
        disabled: true
      enabled: true
    database:
      shared: true
      type: "postgres"
      enabled: true
    onlyoffice:
      image:            "onlyoffice/documentserver"
      version:          "latest"
      name:             "onlyoffice"
      cpus:             2
      mem_reservation:  "1g"
      # Raised due to failures in CI pipeline (Good luck approach)
      mem_limit:        "4g"
      pids_limit:       8192
    css:
      enabled: true
  volumes:
    data:         onlyoffice_data          # /var/www/onlyoffice/Data
    logs:         onlyoffice_logs          # /var/log/onlyoffice
    fonts:        onlyoffice_fonts         # /usr/share/fonts/truetype/custom
    lib:          onlyoffice_lib           # /var/lib/onlyoffice
    rabbitmqdata: onlyoffice_rabbitmqdata  # /var/lib/rabbitmq
    
    # The redis and db volume are just dummy volumes and aren't used 
    pgdata:       onlyoffice_pgdata        # /var/lib/postgresql
    redisdata:    onlyoffice_redisdata     # /var/lib/redis
