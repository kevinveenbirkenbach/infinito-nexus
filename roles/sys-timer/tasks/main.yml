# run_once_sys_timer: deactivated

- name: create {{ sys_timer_file }}
  template:
    src: dummy.timer.j2
    dest: "{{ [ DIR_SYSTEM_SERVICE, sys_timer_file ] | path_join }}"
  register: dummy_timer

- name: "deploy timer"
  systemd:
    daemon_reload: yes
    name: "{{ sys_timer_file }}"
    state: stopped
    enabled: false
  when: dummy_timer.changed or SYS_TIMER_ALL_ENABLED | bool
  async: "{{ ASYNC_TIME if ASYNC_ENABLED | bool else omit }}"
  poll:  "{{ ASYNC_POLL if ASYNC_ENABLED | bool else omit }}"
