- name: Ensure all required NGINX host directories exist (single task)
  become: true
  ansible.builtin.file:
    path: "{{ item.path }}"
    state: directory
    owner: "{{ lookup('nginx','user') }}"
    group: "{{ lookup('nginx','user') }}"
    mode: "{{ item.mode }}"
    recurse: true
  loop: "{{ lookup('nginx','directories.ensure') }}"
  loop_control:
    label: "{{ item.path }}"
