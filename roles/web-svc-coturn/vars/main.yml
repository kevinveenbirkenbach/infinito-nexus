# General
application_id:             "web-svc-coturn"
entity_name:                "{{ application_id | get_entity_name }}"
domain:                     "{{ domains | get_domain(application_id) }}"

# Coturn 

## Docker 
COTURN_VERSION:             "{{ applications | get_app_conf(application_id, 'docker.services.' ~ entity_name ~ '.version') }}"
COTURN_IMAGE:               "{{ applications | get_app_conf(application_id, 'docker.services.' ~ entity_name ~ '.image') }}"
COTURN_VOLUME:              "{{ entity_name }}_data"
COTURN_CONTAINER:           "{{ entity_name }}"
COTURN_REALM:               "{{ domain }}"
COTURN_NETWORK_MODE:        "{{ applications | get_app_conf(application_id, 'docker.services.' ~ entity_name ~ '.network_mode') }}"

## Ports
COTURN_STUN_TURN_PORT:      "{{ ports.public.stun_turn[application_id] }}"
COTURN_STUN_TURN_PORT_TLS:  "{{ ports.public.stun_turn_tls[application_id] }}"
COTURN_RELAY_PORT_START:    "{{ ports.public.relay_port_ranges[application_id ~ '_start'] }}"
COTURN_RELAY_PORT_END:      "{{ ports.public.relay_port_ranges[application_id ~ '_end'  ] }}"
COTURN_RELAY_PORT_RANGE:    "{{ COTURN_RELAY_PORT_START }}-{{ COTURN_RELAY_PORT_END }}"

## Credentials 
COTURN_USER_NAME:           "{{ applications | get_app_conf(application_id, 'username') }}"
COTURN_USER_PASSWORD:       "{{ applications | get_app_conf(application_id, 'credentials.user_password') }}"
COTURN_STATIC_AUTH_SECRET:  "{{ applications | get_app_conf(application_id, 'credentials.auth_secret') }}"
COTURN_USER_AUTH_ENABLED:   "{{ applications | get_app_conf(application_id, 'docker.services.' ~ entity_name ~ '.user_auth_enabled') }}"

## TLS
COTURN_TLS_ENABLED:         "{{ lookup('tls', application_id, 'enabled') | bool }}"
COTURN_TLS_CERT_PATH:       "{{ lookup('cert_plan', application_id, 'files.cert') }}"
COTURN_TLS_KEY_PATH:        "{{ lookup('cert_plan', application_id, 'files.key') }}"
