# General
application_id:                   "web-app-joomla"
container_port:                   80
webserver_client_max_body_size:   "{{ JOOMLA_POST_MAX_SIZE }}"
entity_name:                      "{{ application_id | get_entity_name }}"

# Joomla
JOOMLA_VERSION:                   "{{ applications | get_app_conf(application_id, 'docker.services.joomla.version') }}"
JOOMLA_IMAGE:                     "{{ applications | get_app_conf(application_id, 'docker.services.joomla.image') }}"
JOOMLA_CONTAINER:                 "{{ applications | get_app_conf(application_id, 'docker.services.joomla.name') }}"
JOOMLA_VOLUME:                    "{{ applications | get_app_conf(application_id, 'docker.volumes.data') }}"
JOOMLA_CUSTOM_IMAGE:              "{{ entity_name }}_custom:{{ JOOMLA_VERSION }}"
JOOMLA_DOMAINS:                   "{{ applications | get_app_conf(application_id, 'server.domains.canonical') }}"
JOOMLA_SITE_NAME:                 "{{ SOFTWARE_NAME }} Joomla - CMS"
JOOMLA_DB_CONNECTOR:              "{{ 'pgsql' if database_type == 'postgres' else 'mysqli' }}"
JOOMLA_CONFIG_FILE:               "/var/www/html/configuration.php"
JOOMLA_INSTALLER_CLI_FILE:        "/var/www/html/installation/joomla.php"
JOOMLA_CLI_FILE:                  "/var/www/html/cli/joomla.php"

## Upload
JOOMLA_UPLOAD_CONFIG:             "{{ [ docker_compose.directories.instance, 'php-upload.ini' ] | path_join }}"
JOOMLA_UPLOAD_SIZE:               "{{ applications | get_app_conf(application_id, 'docker.services.joomla.upload.size_mb') }}"
JOOMLA_UPLOAD_MAX_FILESIZE:       "{{ (JOOMLA_UPLOAD_SIZE | int) }}M"
JOOMLA_POST_MAX_SIZE:             "{{ ((JOOMLA_UPLOAD_SIZE | int) * 12 // 10) }}M"

# User
JOOMLA_USER_NAME:                 "{{ users.administrator.username }}"
JOOMLA_USER:                      "{{ JOOMLA_USER_NAME | capitalize }}"     
JOOMLA_USER_PASSWORD:             "{{ users.administrator.password }}"
JOOMLA_USER_EMAIL:                "{{ users.administrator.email }}"
JOOMLA_WEB_USER:                  "www-data"